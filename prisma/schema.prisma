generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model activity_logs {
  action     String    @db.VarChar(100)
  module     String    @db.VarChar(100)
  record_id  String?
  old_value  String?
  new_value  String?
  ip_address String?   @db.VarChar(45)
  user_agent String?
  created_at DateTime? @default(now()) @db.Timestamp(6)
  id         String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_id    String?   @db.Uuid
  users      users?    @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model addresses {
  address_type    String?   @default("permanent") @db.VarChar(50)
  house_number    String?   @db.VarChar(100)
  village_or_city String?   @db.VarChar(255)
  district        String?   @db.VarChar(255)
  state           String?   @db.VarChar(255)
  postal_code     String?   @db.VarChar(10)
  landmark        String?   @db.VarChar(255)
  police_station  String?   @db.VarChar(255)
  post_office     String?   @db.VarChar(255)
  is_current      Boolean?  @default(false)
  created_at      DateTime? @default(now()) @db.Timestamp(6)
  updated_at      DateTime? @default(now()) @db.Timestamp(6)
  id              String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  profile_id      String?   @db.Uuid
  profiles        profiles? @relation(fields: [profile_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model bank_accounts {
  account_holder_name String    @db.VarChar(255)
  account_number      String    @db.VarChar(50)
  ifsc_code           String    @db.VarChar(20)
  bank_name           String?   @db.VarChar(255)
  branch_name         String?   @db.VarChar(255)
  account_type        String?   @default("savings") @db.VarChar(50)
  is_primary          Boolean?  @default(false)
  is_verified         Boolean?  @default(false)
  verification_status String?   @default("pending") @db.VarChar(50)
  verified_at         DateTime? @db.Timestamp(6)
  created_at          DateTime? @default(now()) @db.Timestamp(6)
  updated_at          DateTime? @default(now()) @db.Timestamp(6)
  id                  String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  profile_id          String?   @db.Uuid
  verified_by_user_id String?   @db.Uuid
  profiles            profiles? @relation(fields: [profile_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users               users?    @relation(fields: [verified_by_user_id], references: [id], onUpdate: NoAction)
}

model batch_enrollments {
  enrollment_date       DateTime?         @default(now()) @db.Timestamp(6)
  completion_date       DateTime?         @db.Date
  status                String?           @default("enrolled") @db.VarChar(50)
  attendance_percentage Decimal?          @db.Decimal(5, 2)
  score                 Decimal?          @db.Decimal(5, 2)
  notes                 String?
  created_at            DateTime?         @default(now()) @db.Timestamp(6)
  updated_at            DateTime?         @default(now()) @db.Timestamp(6)
  id                    String            @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  profile_id            String?           @db.Uuid
  batch_id              String?           @db.Uuid
  enrolled_by_user_id   String?           @db.Uuid
  training_batches      training_batches? @relation(fields: [batch_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users                 users?            @relation(fields: [enrolled_by_user_id], references: [id], onUpdate: NoAction)
  profiles              profiles?         @relation(fields: [profile_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  documents             documents[]

  @@unique([profile_id, batch_id], map: "uq_profile_batch")
  @@index([batch_id, status], map: "idx_batch_enrollments_batch_status")
  @@index([profile_id, status], map: "idx_batch_enrollments_profile_status")
}

model blogs {
  id                 BigInt   @id @default(autoincrement())
  created_at         DateTime @default(now()) @db.Timestamptz(6)
  title              String?  @db.VarChar
  content            String?  @db.VarChar
  image_url          String?  @db.VarChar
  category           String?  @db.VarChar
  created_by_user_id String?  @db.Uuid
  users              users?   @relation(fields: [created_by_user_id], references: [id], onDelete: Cascade)
}

model document_categories {
  id          String      @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name        String      @unique @db.VarChar
  description String?
  is_active   Boolean?    @default(true)
  documents   documents[]
}

model documents {
  document_number                            String?              @db.VarChar(100)
  file_name                                  String               @db.VarChar(255)
  file_url                                   String               @db.VarChar(500)
  file_size                                  Int?
  verification_status                        String?              @default("pending") @db.VarChar(50)
  verified_at                                DateTime?            @db.Timestamp(6)
  uploaded_at                                DateTime?            @default(now()) @db.Timestamp(6)
  expiry_date                                DateTime?            @db.Date
  created_at                                 DateTime?            @default(now()) @db.Timestamp(6)
  id                                         String               @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  profile_id                                 String?              @db.Uuid
  uploaded_by_user_id                        String?              @db.Uuid
  verified_by_user_id                        String?              @db.Uuid
  document_category_id                       String?              @db.Uuid
  qualification_id                           String?              @db.Uuid
  batch_enrollment_id                        String?              @db.Uuid
  batch_enrollments                          batch_enrollments?   @relation(fields: [batch_enrollment_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  document_categories                        document_categories? @relation(fields: [document_category_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  profiles                                   profiles?            @relation(fields: [profile_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  qualifications                             qualifications?      @relation(fields: [qualification_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  users_documents_uploaded_by_user_idTousers users?               @relation("documents_uploaded_by_user_idTousers", fields: [uploaded_by_user_id], references: [id], onUpdate: NoAction)
  users_documents_verified_by_user_idTousers users?               @relation("documents_verified_by_user_idTousers", fields: [verified_by_user_id], references: [id], onUpdate: NoAction)
}

model employer_authorized_persons {
  id          String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  employer_id String    @db.Uuid
  name        String?   @db.VarChar
  designation String?   @db.VarChar
  email       String?   @db.VarChar
  phone       String?   @db.VarChar
  address     String?
  is_primary  Boolean?  @default(true)
  created_at  DateTime? @default(now()) @db.Timestamp(6)
  updated_at  DateTime? @default(now()) @db.Timestamp(6)
  employers   employers @relation(fields: [employer_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([employer_id], map: "idx_employer_authorized_persons_employer_id")
}

model employers {
  employer_code                              String                        @unique @db.VarChar(50)
  company_name                               String                        @db.VarChar(255)
  client_name                                String                        @db.VarChar(255)
  email                                      String                        @unique @db.VarChar(255)
  password_hash                              String                        @db.VarChar(255)
  phone                                      String                        @db.VarChar(20)
  alt_phone                                  String?                       @db.VarChar(20)
  registered_address                         String?
  company_registration_number                String?                       @db.VarChar(100)
  gst_number                                 String?                       @db.VarChar(20)
  is_active                                  Boolean?                      @default(true)
  is_verified                                Boolean?                      @default(false)
  verified_at                                DateTime?                     @db.Timestamp(6)
  last_login                                 DateTime?                     @db.Timestamp(6)
  created_at                                 DateTime?                     @default(now()) @db.Timestamp(6)
  updated_at                                 DateTime?                     @default(now()) @db.Timestamp(6)
  id                                         String                        @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  verified_by_user_id                        String?                       @db.Uuid
  deleted_at                                 DateTime?                     @db.Timestamp(6)
  deleted_by_user_id                         String?                       @db.Uuid
  employer_authorized_persons                employer_authorized_persons[]
  users_employers_deleted_by_user_idTousers  users?                        @relation("employers_deleted_by_user_idTousers", fields: [deleted_by_user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  users_employers_verified_by_user_idTousers users?                        @relation("employers_verified_by_user_idTousers", fields: [verified_by_user_id], references: [id], onUpdate: NoAction)
  project_requests                           project_requests[]
  projects                                   projects[]
}

model interaction_types {
  id           String         @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name         String         @unique @db.VarChar
  is_active    Boolean?       @default(true)
  interactions interactions[]
}

model interactions {
  interaction_date    DateTime?          @default(now()) @db.Timestamp(6)
  subject             String?            @db.VarChar(255)
  description         String?
  outcome             String?            @db.VarChar(100)
  next_follow_up_date DateTime?          @db.Date
  created_at          DateTime?          @default(now()) @db.Timestamp(6)
  updated_at          DateTime?          @default(now()) @db.Timestamp(6)
  id                  String             @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  profile_id          String?            @db.Uuid
  created_by_user_id  String?            @db.Uuid
  interaction_type_id String?            @db.Uuid
  profiles            profiles?          @relation(fields: [profile_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_interactions_profiles")
  users               users?             @relation(fields: [created_by_user_id], references: [id], onUpdate: NoAction)
  interaction_types   interaction_types? @relation(fields: [interaction_type_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model news_updates {
  project_name      String    @db.VarChar(500)
  sector            String    @default("N/A") @db.VarChar(200)
  company_authority String?   @db.VarChar(300)
  location          String?   @db.VarChar(300)
  value_cr          Decimal   @default(0) @db.Decimal(15, 2)
  status            String?   @db.VarChar(100)
  revised_budget    Decimal?  @db.Decimal(15, 2)
  revised_timeline  String?   @db.VarChar(200)
  delay_reason      String?
  source_url        String    @unique @db.VarChar(1000)
  source_type       String?   @db.VarChar(100)
  summary_remarks   String    @default("N/A")
  scraped_date      DateTime? @default(now()) @db.Timestamp(6)
  created_at        DateTime? @default(now()) @db.Timestamp(6)
  updated_at        DateTime? @default(now()) @db.Timestamp(6)
  id                String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid

  @@index([created_at], map: "idx_news_updates_created_at")
  @@index([scraped_date], map: "idx_news_updates_scraped_date")
  @@index([sector], map: "idx_news_updates_sector")
  @@index([source_url], map: "idx_news_updates_source_url")
  @@index([status], map: "idx_news_updates_status")
  @@index([value_cr], map: "idx_news_updates_value_cr")
}

model profile_blacklist {
  id                                                      String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  profile_id                                              String    @db.Uuid
  reason                                                  String?
  blacklisted_at                                          DateTime? @default(now()) @db.Timestamp(6)
  blacklisted_by_user_id                                  String?   @db.Uuid
  unblacklisted_at                                        DateTime? @db.Timestamp(6)
  unblacklisted_by_user_id                                String?   @db.Uuid
  is_active                                               Boolean?  @default(true)
  created_at                                              DateTime? @default(now()) @db.Timestamp(6)
  users_profile_blacklist_blacklisted_by_user_idTousers   users?    @relation("profile_blacklist_blacklisted_by_user_idTousers", fields: [blacklisted_by_user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  profiles                                                profiles  @relation(fields: [profile_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  users_profile_blacklist_unblacklisted_by_user_idTousers users?    @relation("profile_blacklist_unblacklisted_by_user_idTousers", fields: [unblacklisted_by_user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([is_active], map: "idx_profile_blacklist_is_active")
  @@index([profile_id], map: "idx_profile_blacklist_profile_id")
}

model profile_salary_slips {
  id                  Int       @id @default(autoincrement())
  profile_id          String    @db.Uuid
  salary_month        Int
  salary_year         Int
  slip_document_url   String?   @db.VarChar(1000)
  slip_file_name      String?   @db.VarChar(255)
  payment_date        DateTime? @db.Date
  payment_status      String?   @default("pending") @db.VarChar(50)
  payment_reference   String?   @db.VarChar(200)
  payment_mode        String?   @db.VarChar(50)
  notes               String?
  uploaded_by_user_id String?   @db.Uuid
  approved_by_user_id String?   @db.Uuid
  created_at          DateTime? @default(now()) @db.Timestamp(6)
  updated_at          DateTime? @default(now()) @db.Timestamp(6)
  profiles            profiles  @relation(fields: [profile_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([profile_id, salary_month, salary_year], map: "uq_profile_salary_month")
  @@index([salary_year, salary_month], map: "idx_salary_slips_period")
  @@index([profile_id], map: "idx_salary_slips_profile")
  @@index([profile_id, salary_year, salary_month], map: "idx_salary_slips_profile_period")
  @@index([payment_status], map: "idx_salary_slips_status")
}

model profile_skills {
  years_of_experience Int?              @default(0)
  is_primary          Boolean?          @default(false)
  verified_at         DateTime?         @db.Timestamp(6)
  created_at          DateTime?         @default(now()) @db.Timestamp(6)
  updated_at          DateTime?         @default(now()) @db.Timestamp(6)
  id                  String            @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  profile_id          String?           @db.Uuid
  skill_category_id   String?           @db.Uuid
  verified_by_user_id String?           @db.Uuid
  profiles            profiles?         @relation(fields: [profile_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_profile_skills_profiles")
  skill_categories    skill_categories? @relation(fields: [skill_category_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_profile_skills_skill_categories")
  users               users?            @relation(fields: [verified_by_user_id], references: [id], onUpdate: NoAction)

  @@index([skill_category_id, is_primary], map: "idx_profile_skills_skill_primary")
}

model profiles {
  candidate_code                 String                       @unique(map: "profiles_profile_code_key") @db.VarChar(50)
  phone                          String                       @unique(map: "profiles_mobile_number_key") @db.VarChar(20)
  alt_phone                      String?                      @db.VarChar(20)
  email                          String?                      @db.VarChar(255)
  first_name                     String                       @db.VarChar(255)
  middle_name                    String?                      @db.VarChar(255)
  last_name                      String?                      @db.VarChar(255)
  fathers_name                   String?                      @db.VarChar(255)
  gender                         String?                      @db.VarChar(20)
  date_of_birth                  DateTime?                    @db.Date
  is_active                      Boolean?                     @default(true)
  created_at                     DateTime?                    @default(now()) @db.Timestamp(6)
  updated_at                     DateTime?                    @default(now()) @db.Timestamp(6)
  profile_photo_url              String?                      @db.VarChar(500)
  id                             String                       @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  deleted_at                     DateTime?                    @db.Timestamp(6)
  deleted_by_user_id             String?                      @db.Uuid
  previous_stage                 String?                      @db.VarChar(50)
  esic_number                    String?                      @db.VarChar(17)
  uan_number                     String?                      @db.VarChar(12)
  pf_account_number              String?                      @db.VarChar(100)
  pan_number                     String?                      @db.VarChar(10)
  health_insurance_policy_number String?                      @db.VarChar(100)
  aadhaar_number                 String?                      @db.VarChar(12)
  emergency_contact_name         String?                      @db.VarChar(255)
  emergency_contact_number       String?                      @db.VarChar(20)
  languages_known                String?                      @db.VarChar(500)
  nominee_name                   String?                      @db.VarChar(255)
  blood_group                    String?                      @db.VarChar(10)
  current_stage                  String?                      @default("new") @db.VarChar(50)
  password_hash                  String?                      @db.VarChar(255)
  primary_skill_id               String?                      @db.Uuid
  addresses                      addresses[]
  bank_accounts                  bank_accounts[]
  batch_enrollments              batch_enrollments[]
  certificates                   certificates[]
  documents                      documents[]
  interactions                   interactions[]
  profile_blacklist              profile_blacklist[]
  profile_salary_slips           profile_salary_slips[]
  profile_skills                 profile_skills[]
  trainer                        trainers?
  users                          users?                       @relation(fields: [deleted_by_user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  primary_skill                  skill_categories?            @relation("ProfilePrimarySkill", fields: [primary_skill_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  project_worker_assignments     project_worker_assignments[]
  qualifications                 qualifications[]
  stage_transitions              stage_transitions[]

  @@index([esic_number], map: "idx_profiles_esic")
  @@index([pan_number], map: "idx_profiles_pan")
  @@index([uan_number], map: "idx_profiles_uan")
  @@index([primary_skill_id], map: "idx_profiles_primary_skill")
}

model project_financials {
  id                     String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  project_id             String    @unique @db.Uuid
  contract_value         Decimal?  @db.Decimal
  revised_contract_value Decimal?  @db.Decimal
  variation_order_value  Decimal?  @default(0) @db.Decimal
  actual_cost_incurred   Decimal?  @default(0) @db.Decimal
  misc_cost              Decimal?  @default(0) @db.Decimal
  budget                 Decimal?  @db.Decimal
  created_at             DateTime? @default(now()) @db.Timestamp(6)
  updated_at             DateTime? @default(now()) @db.Timestamp(6)
  projects               projects  @relation(fields: [project_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([project_id], map: "idx_project_financials_project_id")
}

model project_request_requirements {
  id                 String           @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  project_request_id String           @db.Uuid
  skill_category_id  String           @db.Uuid
  required_count     Int              @default(0)
  notes              String?
  created_at         DateTime?        @default(now()) @db.Timestamp(6)
  updated_at         DateTime?        @default(now()) @db.Timestamp(6)
  project_requests   project_requests @relation(fields: [project_request_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  skill_categories   skill_categories @relation(fields: [skill_category_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model project_requests {
  project_title                String                         @db.VarChar(255)
  project_description          String?
  location                     String?                        @db.VarChar(255)
  estimated_start_date         DateTime?                      @db.Date
  estimated_duration_days      Int?
  estimated_budget             Decimal?                       @db.Decimal(15, 2)
  additional_notes             String?
  status                       String                         @default("pending") @db.VarChar(50)
  reviewed_at                  DateTime?                      @db.Timestamp(6)
  created_at                   DateTime                       @default(now()) @db.Timestamp(6)
  updated_at                   DateTime                       @default(now()) @db.Timestamp(6)
  id                           String                         @id(map: "employer_project_requirements_pkey") @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  employer_id                  String?                        @db.Uuid
  project_id                   String?                        @db.Uuid
  reviewed_by_user_id          String?                        @db.Uuid
  project_request_requirements project_request_requirements[]
  employers                    employers?                     @relation(fields: [employer_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "employer_project_requirements_employer_id_fkey")
  projects                     projects?                      @relation(fields: [project_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "employer_project_requirements_project_id_fkey")
  users                        users?                         @relation(fields: [reviewed_by_user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "employer_project_requirements_reviewed_by_user_id_fkey")

  @@index([status], map: "idx_employer_project_requirements_status")
}

model project_resource_requirements {
  required_count    Int               @default(0)
  notes             String?
  created_at        DateTime          @default(now()) @db.Timestamp(6)
  updated_at        DateTime          @default(now()) @db.Timestamp(6)
  id                String            @id(map: "project_skill_requirements_pkey") @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  project_id        String?           @db.Uuid
  skill_category_id String?           @db.Uuid
  projects          projects?         @relation(fields: [project_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_project_resource_requirements_projects")
  skill_categories  skill_categories? @relation(fields: [skill_category_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_project_resource_requirements_skill_categories")
}

model project_status_documents {
  id                        String                 @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  project_status_history_id String                 @db.Uuid
  project_id                String                 @db.Uuid
  status                    String                 @db.VarChar(50)
  document_title            String                 @db.VarChar(500)
  file_url                  String                 @db.VarChar(1000)
  uploaded_by_user_id       String?                @db.Uuid
  created_at                DateTime?              @default(now()) @db.Timestamp(6)
  projects                  projects               @relation(fields: [project_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  project_status_history    project_status_history @relation(fields: [project_status_history_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users                     users?                 @relation(fields: [uploaded_by_user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([project_status_history_id], map: "idx_project_status_documents_history")
  @@index([project_id], map: "idx_project_status_documents_project")
  @@index([status], map: "idx_project_status_documents_status")
}

model project_status_history {
  id                       String                     @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  project_id               String                     @db.Uuid
  from_status              String?                    @db.VarChar(50)
  to_status                String                     @db.VarChar(50)
  change_reason            String?
  attributable_to          String?                    @db.VarChar(50)
  status_date              DateTime                   @db.Timestamp(6)
  changed_by_user_id       String?                    @db.Uuid
  created_at               DateTime?                  @default(now()) @db.Timestamp(6)
  project_status_documents project_status_documents[]
  users                    users?                     @relation(fields: [changed_by_user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  projects                 projects                   @relation(fields: [project_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([project_id, created_at(sort: Desc)], map: "idx_project_status_history_project_date")
  @@index([to_status], map: "idx_project_status_history_status")
}

model project_worker_assignments {
  id                  String           @id(map: "project_matched_profiles_pkey") @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  project_id          String           @db.Uuid
  profile_id          String           @db.Uuid
  skill_category_id   String           @db.Uuid
  status              String?          @default("matched") @db.VarChar(50)
  created_at          DateTime         @default(now()) @db.Timestamp(6)
  updated_at          DateTime         @default(now()) @db.Timestamp(6)
  assigned_by_user_id String?          @db.Uuid
  shared_at           DateTime?        @db.Timestamp(6)
  shared_by_user_id   String?          @db.Uuid
  onboarded_date      DateTime?        @db.Timestamp(6)
  deployed_date       DateTime?        @db.Timestamp(6)
  removed_at          DateTime?        @db.Timestamp(6)
  removed_by_user_id  String?          @db.Uuid
  removal_reason      String?
  profiles            profiles         @relation(fields: [profile_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "project_matched_profiles_profile_id_fkey")
  projects            projects         @relation(fields: [project_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "project_matched_profiles_project_id_fkey")
  skill_categories    skill_categories @relation(fields: [skill_category_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "project_matched_profiles_skill_category_id_fkey")
  users_assigned_by   users?           @relation("assignment_assigned_by", fields: [assigned_by_user_id], references: [id], onUpdate: NoAction)
  users_removed_by    users?           @relation("assignment_removed_by", fields: [removed_by_user_id], references: [id], onUpdate: NoAction)

  @@unique([project_id, profile_id, skill_category_id], map: "project_matched_profiles_project_id_profile_id_skill_catego_key")
  @@index([profile_id], map: "idx_project_matched_profiles_profile")
  @@index([project_id], map: "idx_project_matched_profiles_project")
  @@index([skill_category_id], map: "idx_project_matched_profiles_skill")
  @@index([assigned_by_user_id], map: "idx_project_worker_assignments_assigned_by")
  @@index([removed_by_user_id], map: "idx_project_worker_assignments_removed_by")
}

model projects {
  code                                     String                          @unique(map: "projects_project_code_key") @db.VarChar(50)
  name                                     String                          @db.VarChar(255)
  location                                 String?                         @db.VarChar(255)
  contact_phone                            String?                         @db.VarChar(20)
  deployment_date                          DateTime?                       @db.Date
  award_date                               DateTime?                       @db.Date
  start_date                               DateTime?                       @db.Date
  end_date                                 DateTime?                       @db.Date
  revised_completion_date                  DateTime?                       @db.Date
  status                                   String?                         @default("planning") @db.VarChar(50)
  project_manager                          String?                         @db.VarChar(255)
  description                              String?
  po_co_number                             String?                         @db.VarChar(100)
  is_active                                Boolean?                        @default(true)
  is_accommodation_provided                Boolean?                        @default(false)
  created_at                               DateTime?                       @default(now()) @db.Timestamp(6)
  updated_at                               DateTime?                       @default(now()) @db.Timestamp(6)
  id                                       String                          @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  employer_id                              String?                         @db.Uuid
  created_by_user_id                       String?                         @db.Uuid
  deleted_at                               DateTime?                       @db.Timestamp(6)
  deleted_by_user_id                       String?                         @db.Uuid
  status_changed_at                        DateTime?                       @db.Timestamp(6)
  status_change_reason                     String?
  actual_start_date                        DateTime?                       @db.Date
  actual_end_date                          DateTime?                       @db.Date
  current_attributable_to                  String?                         @db.VarChar(50)
  on_hold_reason                           String?                         @db.VarChar(50)
  termination_date                         DateTime?                       @db.Date
  termination_reason                       String?
  certificates                             certificates[]
  project_financials                       project_financials?
  project_requests                         project_requests[]
  project_resource_requirements            project_resource_requirements[]
  project_status_documents                 project_status_documents[]
  project_status_history                   project_status_history[]
  project_worker_assignments               project_worker_assignments[]
  employers                                employers?                      @relation(fields: [employer_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_projects_employers")
  users_projects_created_by_user_idTousers users?                          @relation("projects_created_by_user_idTousers", fields: [created_by_user_id], references: [id], onUpdate: NoAction)
  users_projects_deleted_by_user_idTousers users?                          @relation("projects_deleted_by_user_idTousers", fields: [deleted_by_user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model qualification_types {
  id             String           @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name           String           @unique @db.VarChar
  description    String?
  is_active      Boolean?         @default(true)
  qualifications qualifications[]
}

model qualifications {
  institution_name      String?              @db.VarChar(255)
  field_of_study        String?              @db.VarChar(255)
  year_of_completion    Int?
  percentage_or_grade   String?              @db.VarChar(50)
  verified_at           DateTime?            @db.Timestamp(6)
  created_at            DateTime?            @default(now()) @db.Timestamp(6)
  id                    String               @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  profile_id            String?              @db.Uuid
  verified_by_user_id   String?              @db.Uuid
  qualification_type_id String?              @db.Uuid
  documents             documents[]
  profiles              profiles?            @relation(fields: [profile_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_qualifications_profiles")
  qualification_types   qualification_types? @relation(fields: [qualification_type_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  users                 users?               @relation(fields: [verified_by_user_id], references: [id], onUpdate: NoAction)
}

model role_permissions {
  id             String   @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  role_id        String   @db.Uuid
  module_name    String   @db.VarChar(100)
  can_view       Boolean  @default(false)
  can_manage     Boolean  @default(false)
  can_export     Boolean  @default(false)
  is_super_admin Boolean  @default(false)
  created_at     DateTime @default(now()) @db.Timestamp(6)
  updated_at     DateTime @default(now()) @db.Timestamp(6)
  roles          roles    @relation(fields: [role_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([role_id, module_name], map: "uq_role_module")
  @@index([module_name], map: "idx_role_permissions_module_name")
  @@index([role_id], map: "idx_role_permissions_role_id")
}

model roles {
  id               String             @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name             String             @unique @db.VarChar(100)
  description      String?
  is_active        Boolean            @default(true)
  created_at       DateTime           @default(now()) @db.Timestamp(6)
  updated_at       DateTime           @default(now()) @db.Timestamp(6)
  role_permissions role_permissions[]
  users            users[]

  @@index([is_active], map: "idx_roles_is_active")
  @@index([name], map: "idx_roles_name")
}

model scraper_websites {
  url        String    @unique @db.VarChar(1000)
  type       String?   @default("other") @db.VarChar(20)
  is_active  Boolean?  @default(true)
  created_at DateTime? @default(now()) @db.Timestamp(6)
  updated_at DateTime? @default(now()) @db.Timestamp(6)
  name       String?   @db.VarChar(300)
  id         String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid

  @@index([is_active], map: "idx_scraper_websites_is_active")
  @@index([type], map: "idx_scraper_websites_type")
}

model skill_categories {
  name                          String                          @unique @db.VarChar(255)
  description                   String?
  is_active                     Boolean?                        @default(true)
  created_at                    DateTime?                       @default(now()) @db.Timestamp(6)
  updated_at                    DateTime?                       @default(now()) @db.Timestamp(6)
  id                            String                          @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  profile_skills                profile_skills[]
  profiles_with_primary_skill   profiles[]                      @relation("ProfilePrimarySkill")
  project_request_requirements  project_request_requirements[]
  project_resource_requirements project_resource_requirements[]
  project_worker_assignments    project_worker_assignments[]
}

model social_media_platform_posts {
  platform           String              @db.VarChar(50)
  platform_post_id   String?             @db.VarChar(255)
  status             String?             @default("pending") @db.VarChar(50)
  published_at       DateTime?           @db.Timestamptz(6)
  error_message      String?
  engagement         Json?               @default("{}")
  created_at         DateTime?           @default(now()) @db.Timestamptz(6)
  updated_at         DateTime?           @default(now()) @db.Timestamptz(6)
  id                 String              @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  post_id            String?             @db.Uuid
  social_media_posts social_media_posts? @relation(fields: [post_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_social_media_platform_posts")

  @@index([platform], map: "idx_platform_posts_platform")
  @@index([status], map: "idx_platform_posts_status")
}

model social_media_posts {
  title                       String?                       @db.VarChar(500)
  caption                     String?
  description                 String?
  content                     String
  platforms                   String[]
  tags                        String[]                      @default([])
  image_url                   String?
  video_url                   String?
  media_urls                  String[]                      @default([])
  project_name                String?                       @db.VarChar(500)
  source_url                  String?
  status                      String?                       @default("draft") @db.VarChar(50)
  scheduled_at                DateTime?                     @db.Timestamptz(6)
  published_at                DateTime?                     @db.Timestamptz(6)
  make_response               Json?
  make_webhook_id             String?                       @db.VarChar(255)
  platform_content            Json?
  youtube_category            String?                       @db.VarChar(100)
  youtube_privacy             String?                       @default("public") @db.VarChar(20)
  youtube_thumbnail           String?
  engagement                  Json?                         @default("{}")
  created_by                  String?                       @db.VarChar(255)
  created_at                  DateTime?                     @default(now()) @db.Timestamptz(6)
  updated_at                  DateTime?                     @default(now()) @db.Timestamptz(6)
  id                          String                        @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  social_media_platform_posts social_media_platform_posts[]

  @@index([created_at(sort: Desc)], map: "idx_social_media_posts_created_at")
  @@index([platforms], map: "idx_social_media_posts_platforms", type: Gin)
  @@index([published_at(sort: Desc)], map: "idx_social_media_posts_published_at")
  @@index([scheduled_at], map: "idx_social_media_posts_scheduled_at")
  @@index([status], map: "idx_social_media_posts_status")
  @@index([tags], map: "idx_social_media_posts_tags", type: Gin)
}

model stage_transitions {
  from_stage              String?   @db.VarChar(50)
  to_stage                String    @db.VarChar(50)
  transitioned_at         DateTime? @default(now()) @db.Timestamp(6)
  notes                   String?
  id                      String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  profile_id              String?   @db.Uuid
  transitioned_by_user_id String?   @db.Uuid
  profiles                profiles? @relation(fields: [profile_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_stage_transitions_profiles")
  users                   users?    @relation(fields: [transitioned_by_user_id], references: [id], onUpdate: NoAction)

  @@index([profile_id, transitioned_at(sort: Desc)], map: "idx_stage_transitions_profile_date")
}

model trainers {
  id                      String                    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  profile_id              String                    @unique @db.Uuid
  specialization          String?                   @db.VarChar(500)
  certifications          String?
  years_of_experience     Int?
  bio                     String?
  is_active               Boolean?                  @default(true)
  created_by_user_id      String?                   @db.Uuid
  created_at              DateTime?                 @default(now()) @db.Timestamp(6)
  updated_at              DateTime?                 @default(now()) @db.Timestamp(6)
  profiles                profiles                  @relation(fields: [profile_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users                   users?                    @relation(fields: [created_by_user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  trainer_batch_assignments trainer_batch_assignments[]

  @@index([profile_id], map: "idx_trainers_profile_id")
  @@index([is_active], map: "idx_trainers_is_active")
}

model trainer_batch_assignments {
  id               String            @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  trainer_id       String            @db.Uuid
  training_batch_id String           @db.Uuid
  shift            String            @db.VarChar(20)
  assigned_date    DateTime?         @default(now()) @db.Timestamp(6)
  assigned_by_user_id String?        @db.Uuid
  is_active        Boolean?          @default(true)
  created_at       DateTime?         @default(now()) @db.Timestamp(6)
  updated_at       DateTime?         @default(now()) @db.Timestamp(6)
  trainers         trainers          @relation(fields: [trainer_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  training_batches training_batches  @relation(fields: [training_batch_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users            users?            @relation(fields: [assigned_by_user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([trainer_id, training_batch_id, shift], map: "uq_trainer_batch_shift")
  @@index([trainer_id], map: "idx_trainer_batch_assignments_trainer")
  @@index([training_batch_id], map: "idx_trainer_batch_assignments_batch")
  @@index([shift], map: "idx_trainer_batch_assignments_shift")
}

model training_batches {
  code                      String                      @unique(map: "training_batches_batch_code_key") @db.VarChar(50)
  name                      String                      @db.VarChar(255)
  program_name              String                      @db.VarChar(255)
  provider                  String?                     @db.VarChar(255)
  start_date                DateTime?                   @db.Date
  end_date                  DateTime?                   @db.Date
  duration_days             Int?
  max_capacity              Int?
  status                    String?                     @default("upcoming") @db.VarChar(50)
  location                  String?                     @db.VarChar(255)
  description               String?
  created_at                DateTime?                   @default(now()) @db.Timestamp(6)
  updated_at                DateTime?                   @default(now()) @db.Timestamp(6)
  id                        String                      @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  created_by_user_id        String?                     @db.Uuid
  batch_enrollments         batch_enrollments[]
  certificates              certificates[]
  users                     users?                      @relation(fields: [created_by_user_id], references: [id], onUpdate: NoAction)
  trainer_batch_assignments trainer_batch_assignments[]

  @@index([status], map: "idx_training_batches_status")
  @@index([start_date], map: "idx_training_batches_start_date")
}

model users {
  username                                                            String                       @unique @db.VarChar(255)
  email                                                               String                       @unique @db.VarChar(255)
  password_hash                                                       String                       @db.VarChar(255)
  full_name                                                           String?                      @db.VarChar(255)
  phone                                                               String?                      @db.VarChar(20)
  is_active                                                           Boolean?                     @default(true)
  last_login                                                          DateTime?                    @db.Timestamp(6)
  created_at                                                          DateTime?                    @default(now()) @db.Timestamp(6)
  updated_at                                                          DateTime?                    @default(now()) @db.Timestamp(6)
  id                                                                  String                       @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  role_id                                                             String?                      @db.Uuid
  activity_logs                                                       activity_logs[]
  bank_accounts                                                       bank_accounts[]
  batch_enrollments                                                   batch_enrollments[]
  blogs                                                               blogs[]
  certificates                                                        certificates[]
  documents_documents_uploaded_by_user_idTousers                      documents[]                  @relation("documents_uploaded_by_user_idTousers")
  documents_documents_verified_by_user_idTousers                      documents[]                  @relation("documents_verified_by_user_idTousers")
  employers_employers_deleted_by_user_idTousers                       employers[]                  @relation("employers_deleted_by_user_idTousers")
  employers_employers_verified_by_user_idTousers                      employers[]                  @relation("employers_verified_by_user_idTousers")
  interactions                                                        interactions[]
  notification_preferences                                            notification_preferences[]
  notifications_received                                              notifications[]              @relation("notifications_recipient")
  notifications_sent                                                  notifications[]              @relation("notifications_sent_by")
  profile_blacklist_profile_blacklist_blacklisted_by_user_idTousers   profile_blacklist[]          @relation("profile_blacklist_blacklisted_by_user_idTousers")
  profile_blacklist_profile_blacklist_unblacklisted_by_user_idTousers profile_blacklist[]          @relation("profile_blacklist_unblacklisted_by_user_idTousers")
  profile_skills                                                      profile_skills[]
  profiles                                                            profiles[]
  project_requests                                                    project_requests[]
  project_status_documents                                            project_status_documents[]
  project_status_history                                              project_status_history[]
  project_worker_assignments_assigned_by                              project_worker_assignments[] @relation("assignment_assigned_by")
  project_worker_assignments_removed_by                               project_worker_assignments[] @relation("assignment_removed_by")
  projects_projects_created_by_user_idTousers                         projects[]                   @relation("projects_created_by_user_idTousers")
  projects_projects_deleted_by_user_idTousers                         projects[]                   @relation("projects_deleted_by_user_idTousers")
  qualifications                                                      qualifications[]
  stage_transitions                                                   stage_transitions[]
  trainers                                                            trainers[]
  trainer_batch_assignments                                           trainer_batch_assignments[]
  training_batches                                                    training_batches[]
  roles                                                               roles?                       @relation(fields: [role_id], references: [id], onUpdate: NoAction)

  @@index([role_id], map: "idx_users_role_id")
}

model notifications {
  id                String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  type              String    @db.VarChar(100)
  title             String    @db.VarChar(255)
  message           String
  recipient_user_id String?   @db.Uuid
  recipient_email   String?   @db.VarChar(255)
  sender_user_id    String?   @db.Uuid
  metadata          Json?
  channels          String[]  @default([])
  status            String    @default("pending") @db.VarChar(50)
  sent_at           DateTime? @db.Timestamp(6)
  read_at           DateTime? @db.Timestamp(6)
  error_message     String?
  retry_count       Int       @default(0)
  created_at        DateTime  @default(now()) @db.Timestamp(6)
  updated_at        DateTime  @default(now()) @db.Timestamp(6)
  recipient         users?    @relation("notifications_recipient", fields: [recipient_user_id], references: [id], onDelete: Cascade)
  sender            users?    @relation("notifications_sent_by", fields: [sender_user_id], references: [id])

  @@index([recipient_user_id, status])
  @@index([type])
  @@index([created_at])
}

model notification_templates {
  id               String   @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  type             String   @unique @db.VarChar(100)
  name             String   @db.VarChar(255)
  description      String?
  subject_template String   @db.VarChar(500)
  body_template    String
  variables        Json?
  default_channels String[] @default(["email", "in_app"])
  is_active        Boolean  @default(true)
  created_at       DateTime @default(now()) @db.Timestamp(6)
  updated_at       DateTime @default(now()) @db.Timestamp(6)

  @@index([type])
}

model notification_preferences {
  id                String   @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_id           String   @db.Uuid
  notification_type String   @db.VarChar(100)
  enabled_channels  String[] @default(["email", "in_app"])
  is_enabled        Boolean  @default(true)
  created_at        DateTime @default(now()) @db.Timestamp(6)
  updated_at        DateTime @default(now()) @db.Timestamp(6)
  user              users    @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@unique([user_id, notification_type])
  @@index([user_id])
}

model certificates {
  id                 String   @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  profile_id         String   @db.Uuid
  certificate_type   String   @db.VarChar(50) // 'training' or 'project'
  certificate_url    String   @db.VarChar(500)
  certificate_number String   @unique @db.VarChar(100)
  training_batch_id  String?  @db.Uuid
  project_id         String?  @db.Uuid
  issued_date        DateTime @default(now()) @db.Timestamp(6)
  issued_by_user_id  String?  @db.Uuid
  metadata           Json? // Additional data like course name, duration, etc.
  created_at         DateTime @default(now()) @db.Timestamp(6)
  updated_at         DateTime @default(now()) @db.Timestamp(6)

  // Relations
  profile        profiles          @relation(fields: [profile_id], references: [id], onDelete: Cascade)
  training_batch training_batches? @relation(fields: [training_batch_id], references: [id], onDelete: SetNull)
  project        projects?         @relation(fields: [project_id], references: [id], onDelete: SetNull)
  issued_by      users?            @relation(fields: [issued_by_user_id], references: [id], onDelete: SetNull)

  @@index([profile_id])
  @@index([certificate_type])
  @@index([training_batch_id])
  @@index([project_id])
}
